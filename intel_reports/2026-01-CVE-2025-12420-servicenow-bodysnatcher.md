# Intel Report — BodySnatcher (CVE-2025-12420)
**Topic:** ServiceNow agentic AI / Virtual Agent authentication weakness → impersonation + privileged actions  
**Source:** AppOmni / AO Labs public report (Jan 13, 2026)  
**Confidence:** Medium (single primary public source; validate with vendor advisory + local telemetry)

---

## 1. Executive summary
Public research reports a vulnerability in ServiceNow’s agentic AI ecosystem (CVE-2025-12420) that enables **impersonation through email identity** and can undermine expected **MFA/SSO assurances** in certain integration patterns. The reported impact is not just “chat abuse”—it’s the potential for **unauthorized platform actions executed as another user** through agent workflows.

This is best understood as a **trust boundary failure** between:
- external agent integrations / shared tokens
- account linking and identity binding logic
- tool execution paths that can perform sensitive actions

**Who should care:** teams running ServiceNow **on-prem** with affected Now Assist AI Agents / Virtual Agent API versions and any external agent integration patterns.

---

## 2. Key takeaways (defender lens)
- Agentic AI increases blast radius when identity binding is weak: email-only identity assumptions can enable impersonation.
- MFA/SSO can be *bypassed in practice* when the agent workflow is trusted to act “as the user.”
- The security control plane must include governance for agents:
  - token scope minimization
  - account-link approvals
  - auditing + lifecycle management
  - “tool execution” restrictions and strong guardrails

---

## 3. Affected / fixed versions (from report)
### Now Assist AI Agents
- **Affected:** 5.0.24 – 5.1.17, and 5.2.0 – 5.2.18  
- **Fixed:** 5.1.18 and 5.2.19

### Virtual Agent API
- **Affected:** <= 3.15.1, and 4.0.0 – 4.0.3  
- **Fixed:** 3.15.2 and 4.0.4

**Deployment scope:** Report indicates **cloud-hosted customers are not affected**; prioritize confirming on-prem exposure.

---

## 4. High-level reported exploit concept (non-operational)
The report describes a scenario where:
1) An attacker takes advantage of broken authentication / identity binding within agentic AI integration flows.
2) The platform can be induced to treat the attacker as a victim identity (email-based association).
3) Agent workflows can execute actions “as the impersonated user,” potentially including record creation.
4) If an account is created and privileged, follow-on access may occur via normal authentication flows (e.g., password reset), depending on environment configuration.

We intentionally omit operational details, request structures, and reproduction steps.

---

## 5. Detection & hunting guidance (behavior-first)
### Highest-signal patterns
- **New user creation** closely followed by **admin-like role assignment**
- These identity/privilege events correlate in time with **Virtual Agent / Now Assist sessions**
- **Password reset/account recovery** soon after user creation
- **Agent integration/provider configuration changes** preceding identity/privilege events

### Data sources to prioritize
- ServiceNow audit logs for user/role changes (sys_user, sys_user_has_role)
- Password reset/account recovery audit trails
- Virtual Agent / Now Assist session metadata (session id, who/what initiated, timing)
- Agent workflow/tool execution logs (if available)
- Configuration management logs for agent providers/integrations

See the hunting package for query templates:
- `hunting_packages/CVE-2025-12420/hunt_queries.md`

---

## 6. Mitigation guidance (from report + defender best practice)
**Immediate**
- Upgrade affected components to fixed versions (confirm exact builds).
- Reduce exposure by disabling or restricting external agent integrations until patched.

**Hardening controls to pursue**
- Strengthen identity binding: avoid email-only linking without strong verification
- Enforce explicit approval workflows for account linking and sensitive tool actions
- Minimize token scope; avoid shared tokens where one integration can act broadly
- Monitor and alert on:
  - user creation + privileged role grants
  - agent configuration drift
  - anomalous agent session volumes tied to admin outcomes

---

## 7. Analyst notes / questions to answer locally
- Are we on-prem and within affected version ranges?
- Which agentic AI features are enabled (Now Assist / Virtual Agent / external agent integrations)?
- What audit coverage exists for:
  - user creation, role grants
  - password resets
  - agent tool execution
  - configuration changes
- Can we correlate agent sessions to identity/privilege outcomes reliably?

---

## 8. References
- AppOmni / AO Labs — “BodySnatcher (CVE-2025-12420)” (Jan 13, 2026)
- (TODO) Vendor advisory / CVE record / NVD entry (add once collected)
