meta:
  case_id: CASE-0003
  case_name: DNS Triage + Redirect Chains (Synthetic)
  notes: >
    Demonstrates DNS-based threat detection with explainable heuristics.
    Synthetic domain-to-domain transitions (parent_domain) model redirect-like sequences.

generation:
  seed: 2027
  total_rows: 1000000
  output_dir: datasets/output_case0003
  time_range_utc:
    start: "2025-12-15T00:00:00Z"
    end: "2025-12-22T00:00:00Z"

# Reuse existing entity configs
entities:
  orgs:
    count: 60
    id_prefix: "org_"
    size_distribution:
      small: 0.60
      medium: 0.30
      large: 0.10

  accounts:
    count: 8000
    id_prefix: "acct_"
    accounts_per_org:
      small_range: [30, 110]
      medium_range: [90, 220]
      large_range: [180, 520]

  devices:
    count: 12000
    id_prefix: "dev_"
    mix:
      normal: 0.90
      suspicious: 0.10
    suspicious_device_traits:
      headless_rate: 0.55
      webdriver_rate: 0.40
      low_entropy_ua_rate: 0.35

infra:
  asn_pool_sizes:
    residential: 120
    corporate: 60
    hosting: 120
    vpn: 90

  baseline_asn_type_probs:
    residential: 0.70
    corporate: 0.18
    hosting: 0.07
    vpn: 0.05

  provider_brand_buckets:
    residential_isp: ["res_isp_a", "res_isp_b", "res_isp_c", "res_isp_d"]
    enterprise_egress: ["corp_egress_a", "corp_egress_b"]
    cloud_datacenter: ["cloud_a", "cloud_b", "cloud_c"]
    vps_hosting: ["vps_a", "vps_b", "vps_c"]
    vpn_service: ["vpn_a", "vpn_b", "vpn_c", "vpn_d"]

models:
  model_names: ["model_a", "model_b", "model_c"]
  baseline_model_probs:
    model_a: 0.55
    model_b: 0.35
    model_c: 0.10

telemetry_schema:
  language_fields:
    baseline_primary_language_probs:
      en: 0.55
      pt: 0.12
      es: 0.12
      ru: 0.08
      fr: 0.07
      de: 0.06

    baseline_ui_language_probs:
      en: 0.62
      pt: 0.10
      es: 0.10
      ru: 0.07
      fr: 0.06
      de: 0.05

content:
  topic_buckets: ["public_services_community", "civics", "local_events", "public_health", "policy_discussion"]
  baseline_topic_probs:
    public_services_community: 0.40
    civics: 0.20
    local_events: 0.15
    public_health: 0.15
    policy_discussion: 0.10

  content_clusters:
    count: 10
    id_prefix: "CT-"

  templates:
    count: 10
    id_prefix: "T-"

moderation:
  baseline_action_probs:
    allow: 0.975
    warn: 0.020
    block: 0.005
  
  campaign_action_probs:
    allow: 0.15
    warn: 0.45
    block: 0.40

rate_limits:
  enabled: false

sessions:
  enabled: false

osint:
  enabled: false

# CASE-0003 specific: DNS events configuration
dns_events:
  enabled: true
  table_name: "dns_events"
  
  # Volume parameters
  benign_queries_per_account: [80, 400]  # Range: each account generates this many benign queries
  malicious_fraction: 0.005              # 0.5% of total DNS events are malicious
  benign_noise_rate: 0.10                # 10% of benign queries trigger 1-2 heuristics (realistic false positives)
  
  # Chain (redirect) parameters
  chain_prob: 0.15                       # Probability a query has a parent_domain (chain edge)
  max_chain_len: 3                       # Max chain depth (A→B→C)
  
  # Heuristic thresholds (from dns_triage.py)
  suspicious_tlds:
    - "xyz"
    - "top"
    - "icu"
    - "club"
    - "link"
    - "click"
    - "tk"
    - "cf"
    - "ml"
    - "ga"
    - "gq"
    - "pw"
    - "win"
    - "loan"
    - "date"
    - "party"
    - "racing"
    - "stream"
    - "bid"
    - "trade"
    - "accountant"
    - "faith"
    - "science"
    - "download"
    - "webcam"
    
  keyword_indicators:
    - "login"
    - "secure"
    - "verification"
    - "verify"
    - "update"
    - "account"
    - "support"
    - "auth"
    - "office"
    - "microsoft"
    - "apple"
    - "paypal"
    - "bank"
    - "wallet"
    - "crypto"
    - "giftcard"
    - "helpdesk"
    
  entropy_threshold: 3.5        # Shannon entropy threshold for high_entropy flag
  rare_domain_threshold: 5      # Query count threshold for rare_domain flag
  
  # Scoring weights (composite score calculation)
  score_weights:
    suspicious_tld: 2
    keyword_hit: 3
    high_entropy: 1
    rare_domain: 1

# Keep campaigns empty for this case
campaigns: []
