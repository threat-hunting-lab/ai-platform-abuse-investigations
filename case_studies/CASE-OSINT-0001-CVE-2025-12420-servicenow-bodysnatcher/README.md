# CASE-OSINT-0001 — BodySnatcher (CVE-2025-12420) — ServiceNow Agentic AI Auth Bypass

## Why this case exists
This case study analyzes a publicly reported vulnerability in ServiceNow’s agentic AI / Virtual Agent ecosystem that enables **impersonation via email identity** and can **bypass expected MFA/SSO protections** under certain integration patterns. The goal here is to translate OSINT into **actionable detection/hunting guidance**, plus a defensible ATT&CK mapping and investigation checklist.

This is an **OSINT-driven** case. No exploit reproduction, no weaponization steps.

## Executive summary (OSINT)
- Public research reported a **broken authentication + “agent hijacking”** condition affecting ServiceNow agentic AI integrations.
- The reported risk is **identity impersonation via email** and **unauthorized actions performed as another user** through agent-to-agent / external agent integration flows.
- **On-prem** customers are impacted; **cloud-hosted customers are reported as not affected**.
- Primary required action: **upgrade ServiceNow components to fixed versions** (see “Affected / fixed versions”).

## Affected / fixed versions (from public report)
### Now Assist AI Agents
- **Affected:** 5.0.24 – 5.1.17, and 5.2.0 – 5.2.18
- **Fixed:** 5.1.18 and 5.2.19

### Virtual Agent API
- **Affected:** <= 3.15.1, and 4.0.0 – 4.0.3
- **Fixed:** 3.15.2 and 4.0.4

> Note: confirm your exact build numbers and deployment topology (on-prem vs hosted) before scoping.

## Threat model (what matters for defenders)
This case is less about “a single endpoint bug” and more about **agentic system design risks**:
- Account linking / identity binding based on weak identifiers (e.g., email-only trust decisions)
- Shared or overly-permissive tokens in agent integrations
- “Tool execution” pathways where an agent can trigger sensitive actions (record creation, role changes) without adequate controls
- Governance gaps: agent lifecycle management, approval policy, and auditing

## High-level reported attack chain (non-operational)
At a high level, the public report describes:
1) Attacker leverages an agent integration weakness to **impersonate a target identity** (email-based identity binding).
2) The attacker sends messages that cause the agent workflow to perform actions **as the impersonated user**.
3) Sensitive actions can include **record/user creation** and potentially privilege-bearing configuration, depending on the environment’s approval controls and role setup.
4) Follow-on actions may include account access via normal platform flows (e.g., password reset) if an attacker-created account exists.

We intentionally omit operational details (exact requests/headers/endpoints).

## What defenders should hunt for
Prioritize behavior over IOCs:
- **New user creation** temporally correlated with **Virtual Agent / Now Assist conversations**
- **Role assignments** (especially admin-like roles) shortly after user creation
- **Password reset / account recovery** events for newly created users
- Changes to **agent provider / agent connection configuration**
- Unusual spikes in Virtual Agent sessions tied to privileged outcomes

See:
- `hunting_packages/CVE-2025-12420/hunt_queries.md`
- `hunting_packages/CVE-2025-12420/attck_mapping.yaml`
- `case_studies/.../attck_notes.md`

## Outputs produced in this repo
- Intel report: `intel_reports/2026-01-CVE-2025-12420-servicenow-bodysnatcher.md`
- Hunting package: `hunting_packages/CVE-2025-12420/*`
- ATT&CK notes + sources: `case_studies/.../*`

## Validation checklist (quick)
- [ ] Confirm environment is **on-prem** and contains affected components/versions
- [ ] Confirm Now Assist / Virtual Agent features enabled + integrated
- [ ] Identify audit sources for: user/role changes, agent workflow/tool execution, account linking
- [ ] Run hunts for “new user + privileged role + agent session correlation”
- [ ] Confirm patch state and reduce token scope / strengthen identity binding controls

## Source
See `links_and_sources.md`.
